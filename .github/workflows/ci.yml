name: CI

on:
  push:
    branches: [ "main", "master" ]
  pull_request:


jobs:
  lint-and-test:
    runs-on: ubuntu-latest
    env:
      PYTHONPATH: ${{ github.workspace }}/src
    steps:
    - name: Check out repository
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.12"

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install \
          pandas==2.3.1 \
          plotly==6.3.0 \
          openpyxl==3.1.5 \
          black==25.1.0 \
          mypy==1.17.1 \
          pylint==3.3.8 \
          pytest==8.4.1 \
          pytest-cov==6.2.1

    - name: Run Black (format check)
      run: black --check .

    - name: Run Pylint
      run: pylint src tests main.py update_task_dates.py

    - name: Run Pytest
      run: pytest
